<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  </head>
  <body>

    <div class="container mx-auto p-4 flex justify-center items-start bg-gray-100 min-h-screen">
      <div class="content max-w-[70%] w-full flex justify-center flex-col items-center gap-4">
        <h1 class="text-3xl font-bold tracking-tight text-gray-900"> CARDÁPIO </h1>

        <!-- MENU -->
        <div class="flex flex-wrap gap-4">
          <div class="p-2 w-17 h-17 flex justify-center items-center flex-col bg-white rounded-sm cursor-pointer hover:bg-gray-200" onclick="enviarDados()">
            <svg class="fill-gray-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="#e3e3e3"><path d="M120-100q-9 0-14.5-5.5T100-120v-40h529.23v40q0 9-5.5 14.5t-14.5 5.5H120Zm-20-147.69v-40q0-9 5.5-14.5t14.5-5.5h164.62v-63.08h160v63.08h164.61q9 0 14.5 5.5t5.5 14.5v40H100ZM727.69-100v-246.31q-32.15-33.31-53-71.19-20.84-37.89-20.84-89.12V-860H860v353.38q0 51.23-19.77 89.43-19.77 38.19-52.54 70.88V-160H860v60H727.69Zm-13.84-532.31H800V-800h-86.15v167.69Zm43.84 229.69q18-17.53 30.16-45.5Q800-476.08 800-506.62v-65.69h-86.15v65.69q0 30.54 12.3 58.5 12.31 27.97 31.54 45.5Zm-.77 0Z"/></svg>
            <p class="font-medium text-xs"> Café </p>
          </div>
          <div class="p-2 w-17 h-17 flex justify-center items-center flex-col bg-white rounded-sm cursor-pointer hover:bg-gray-200">
              <svg class="fill-gray-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="#e3e3e3"><path d="m170.39-130.77-70.77-70.77h759.99l-70.76 70.77H170.39ZM140-245.39q6.39-16.46 16.58-30.92 10.19-14.46 23.42-26.92v-306h-40v-47.69h40v-33.85h-40v-47.69h40v-33.85h-40V-820h263.85q29.82 0 51.06 21.24 21.24 21.24 21.24 51.07v9.23H820v47.69H476.15v9.11q0 30.04-21.24 51.24-21.24 21.19-51.06 21.19h-76.16v258.62q18.62 2.76 36.66 8.88 18.04 6.12 33.5 17.58 17.92-62.69 70.3-101 52.39-38.31 117.93-38.31 80.43 0 137.17 55.14Q780-353.18 780-273.39v28H140Zm317.08-59.99h254.31q-10.47-42.93-45.2-70.5-34.73-27.58-80.11-27.58-46.62 0-82.58 26.96t-46.42 71.12ZM327.69-738.46h88.47V-760q0-5.38-3.47-8.85-3.46-3.46-8.84-3.46h-76.16v33.85Zm0 81.54h76.16q5.38 0 8.84-3.46 3.47-3.47 3.47-8.85v-21.54h-88.47v33.85Zm-100-81.54H280v-33.85h-52.31v33.85Zm0 81.54H280v-33.85h-52.31v33.85Zm0 320.54q12.7-6.54 25.46-10 12.77-3.47 26.85-5.59v-257.26h-52.31v272.85Zm356.54 31Z"/></svg> 
            <p class="font-medium text-xs"> Almoço </p>
          </div>
          <div class="p-2 w-17 h-17 flex justify-center items-center flex-col bg-white rounded-sm cursor-pointer hover:bg-gray-200">
            <svg class="fill-gray-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="#e3e3e3"><path d="M554.16-412.31q-29.31-49.61-85.95-67.11t-117.06-17.5q-60.23 0-117.34 17.5-57.12 17.5-85.66 67.11h406.01Zm-485.31 60q0-98.23 86.77-151.42 86.77-53.19 195.53-53.19 108.77 0 195.54 53.19t86.77 151.42H68.85Zm0 146.16v-60h564.61v60H68.85ZM713.46-60v-60h56l56-552.31H454.23l-7.69-60h192.31v-160h59.99v160h192.31l-62.92 625.08q-2.62 20.77-18.15 34Q794.54-60 773.77-60h-60.31Zm0-60h56-56Zm-612.3 60q-13.74 0-23.02-9.29-9.29-9.29-9.29-23.02V-120h564.61v27.69q0 13.73-9.29 23.02T601.15-60H101.16Zm249.99-352.31Z"/></svg>
            <p class="font-medium text-xs"> Jantar </p>
          </div>
        </div>

        <!-- LISTA DE ITENS -->
        <div class="w-full bg-white rounded-sm flex flex-col gap-2 p-4 pl-10 pr-10">
          <div class="mx-auto overflow-hidden rounded-xl bg-white shadow-md">
            <div class="flex flex-row items-center">
              <img
                class="max-h-30 max-w-30 md:w-full md:h-full object-cover"
                src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSf3_uqLKuV2UWiz3NH9QhLz_VBSXd3_OTMyQ&s"
                alt="Modern building architecture"
              />
  
              <div class="p-2">
                <div class="text-sm font-semibold tracking-wide text-indigo-500 uppercase">Company retreats</div>
                <p class="text-xs text-gray-500">
                  Looking to take your team away on a retreat to enjoy awesome food and take in some sunshine? We have a list of
                  places to do just that.
                </p>
              </div>
            </div>
          </div>

          <div class="mx-auto overflow-hidden rounded-xl bg-white shadow-md">
            <div class="flex flex-row items-center">
              <img
                class="max-h-30 max-w-30 md:w-full md:h-full object-cover"
                src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSf3_uqLKuV2UWiz3NH9QhLz_VBSXd3_OTMyQ&s"
                alt="Modern building architecture"
              />
  
              <div class="p-2">
                <div class="text-sm font-semibold tracking-wide text-indigo-500 uppercase">Company retreats</div>
                <p class="text-xs text-gray-500">
                  Looking to take your team away on a retreat to enjoy awesome food and take in some sunshine? We have a list of
                  places to do just that.
                </p>
              </div>
            </div>
          </div>


        </div>
        <button type="button" class="inline-flex items-center rounded-md bg-indigo-500 px-4 py-2 text-sm leading-6 font-semibold text-white shadow" disabled>
          <svg class="mr-3 -ml-1 h-5 w-5 animate-spin text-white motion-reduce:hidden" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
          Processing...
        </button>
    </div>

    
  </body>
  <script>

    const itemTeste = [
      3541561,
      66,
      'Café Expresso',
      'Café expresso tradicional feito com água quente e grãos moídos na hora.',
    ]


    getDados().then((data) => {
      processarDados(data);
    }).catch((error) => {
      console.error('Erro ao obter dados do servidor:', error);
    });

    function processarDados(dados) {
      if (dados.length === 0) {
        console.log('Nenhum dado disponível.');
        return;
      }

      const keys = processKeys(dados[0]);
      const itens = dados.slice(1).map(linha => {
        const item = {};
        keys.forEach((key, index) => {
          item[key] = linha[index];
        });
        return item;
      });
      
    }

    function processKeys(keys) {
      if (!keys || keys.length === 0) {
        console.log('Nenhuma chave disponível.');
        return [];
      }

      return keys.map(key => {
        const str = String(key).trim().toLowerCase();
        
        return str
          .split(/[-_]/)
          .map((word, index) => {
            if (index === 0) return word;
            return word.charAt(0).toUpperCase() + word.slice(1);
          })
          .join('');
      });
    }
    

    
    function getDados() {
      return new Promise((resolve, reject) => {
        google.script.run
          .withSuccessHandler((data) => resolve(data))
          .withFailureHandler((error) => reject(error))
          .lerDadosPlanilha("TB_ITENS");
      });
    }

      function enviarDados() {
        google.script.run
          .withSuccessHandler(onSuccess)
          .withFailureHandler(onFailure)
          .adicionarDados("TB_ITENS", itemTeste);
      }
   
      function onSuccess(response) {
        if (response.success) {
          alert(response.message, 'success');
        } else {
          alert(response.message, 'error');
        }
      }
      
      function onFailure(error) {        
        alert('Erro ao comunicar com o servidor: ' + error.message, 'error');
      }

    </script>
</html>
